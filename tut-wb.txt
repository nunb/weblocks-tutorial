Weblocks Tutorial (weblocks + ccl + osx + quicklisp)

1. Download quicklisp, run it with ccl and load weblocks. (this part is simple enough to just do a short screencast).
    Briefly:
    cd; mkdir cl; cd cl; 
    wget http://beta.quicklisp.org/quicklisp.lisp
   wget beta.quicklisp.org/quicklisp.lisp;
   rlwrap ccl --load quicklisp.lisp 
   
If this is your first time, QL will prompt you to run (quicklisp-quickstart:install) -- do that. Now  Quicklisp tells us what to do:

   1.    To load a system, use: (ql:quickload "system-name")

   2. To find systems, use: (ql:system-apropos "term")

   3. To load Quicklisp every time you start Lisp, use: (ql:add-to-init-file)

   First do step #3. I also did this step: (ql:quickload "quicklisp-slime-helper")

  Then do step #1 (ql:quickload "weblocks") 

  Enjoy the painless download and install.

   
2. run weblocks:
   ? (weblocks::start-weblocks)
   #<WEBLOCKS-ACCEPTOR (host *, port 8080)>
3. ??? What do people want? Let them tell you. Build a voting system.
4. At repl run (wop:make-app 'tut "/Users/nandan/programming/cl/tut") 



Design:

We shall build a voting system. Start minimal. A title (phrased as a question) and upvotes + downvotes. How do we ensure people vote only once?
We will attempt to ensure fair voting by using a long-running session per user (which in turn will set  a cookie). Since this is a simple project we'll just default to cl-prevalence, which is extremely simple to get started with.

Structures/classes:

votable with upvotes + downvotes
question inherits from votable with a title

Pages:

The landing page should show all outstanding questions before the weblocks community, their upvotes + downvotes. There should be a button to add a question. Perhaps later we can have threaded comments, tickets etc.


So our files:

models.lisp
(defclass* votable ()
  (upvotes :initform 0)
  (downvotes :initform 0))

(defclass* question (votable)
  (title :initform ""))

firstpage.lisp

(defwidget firstpage ()
  (num :initform 30))

(r-w-b firstpage
  (render-list (all-of 'votable-question :sort-by :upvotes)))

(render-list (list)
  (dolist (l list)
    (with-html (:p (format nil l)))))


  
